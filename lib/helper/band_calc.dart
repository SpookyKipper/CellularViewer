String getNrBandName(int frequency) {
  double freqMHz = frequency / 1000.0;

  var bands = [
    // Frequency Range 1
    // n1
    _Band("2100", [1920, 1980], [2110, 2170]),
    // n2
    _Band("1900", [1850, 1910], [1930, 1990]),
    // n3
    _Band("1800", [1710, 1785], [1805, 1880]),
    // n5
    _Band("850", [824, 849], [869, 894]),
    // n7
    _Band("2600", [2500, 2570], [2620, 2690]),
    // n8
    _Band("900", [880, 915], [925, 960]),
    // n12
    _Band("700", [699, 716], [729, 746]),
    // n13
    _Band("700", [777, 787], [746, 756]),
    // n14
    _Band("700", [788, 798], [758, 768]),
    // n18
    _Band("850", [815, 830], [860, 875]),
    // n20
    _Band("800", [832, 862], [791, 821]),
    // n24
    _Band("1600", [1626.5, 1660.5], [1525, 1559]),
    // n25
    _Band("1900", [1850, 1915], [1930, 1995]),
    // n26
    _Band("850", [814, 849], [859, 894]),
    // n28
    _Band("700", [703, 748], [758, 803]),
    // n29
    _Band("700", null, [717, 728]),
    // n30
    _Band("2300", [2305, 2315], [2350, 2360]),
    // n31
    _Band("450", [452.5, 457.5], [462.5, 467.5]),
    // n34
    _Band("2100", [2010, 2025]),
    // n38
    _Band("2600", [2570, 2620]),
    // n39
    _Band("1900", [1880, 1920]),
    // n40
    _Band("2300", [2300, 2400]),
    // n41
    _Band("2500", [2496, 2690]),
    // n46
    _Band("5200", [5150, 5925]),
    // n47
    _Band("5900", [5855, 5925]),
    // n48
    _Band("3500", [3550, 3700]),
    // n50
    _Band("1500", [1432, 1517]),
    // n51
    _Band("1500", [1427, 1432]),
    // n53
    _Band("2400", [2483.5, 2495]),
    // n54
    _Band("1600", [1670, 1675]),
    // n65
    _Band("2100", [1920, 2010], [2110, 2200]),
    // n66
    _Band("1700 2100", [1710, 1780], [2110, 2200]),
    // n67
    _Band("700", null, [738, 758]),
    // n68
    _Band("700", [698, 728], [753, 783]),
    // n70
    _Band("2000", [1695, 1710], [1995, 2020]),
    // n71
    _Band("600", [663, 698], [617, 652]),
    // n72
    _Band("450", [451, 456], [461, 466]),
    // n74
    _Band("1500", [1427, 1470], [1475, 1518]),
    // n75
    _Band("1500", null, [1432, 1517]),
    // n76
    _Band("1500", null, [1427, 1432]),
    // n77
    _Band("3700", [3300, 4200]),
    // n78 (3.3GHz indoor band)
    _Band("3500", [3300, 3399]), 
    // n78 (3.5GHz HK Territory-wide band)
    _Band("3500", [3400, 3800]),
    // n79
    _Band("4500", [4400, 5000]),
    // n80
    _Band("1800", [1710, 1785]),
    // n81
    _Band("900", [880, 915]),
    // n82
    _Band("800", [832, 862]),
    // n83
    _Band("700", [703, 748]),
    // n84
    _Band("2100", [1920, 1980]),
    // n85
    _Band("700", [698, 716], [728, 746]),
    // n86
    _Band("1700", [1710, 1780]),
    // n87
    _Band("400", [410, 415], [420, 425]),
    // n88
    _Band("400", [412, 417], [422, 427]),
    // n89
    _Band("850", [824, 849]),
    // n90
    _Band("2500", [2496, 2690]),
    // n91
    _Band("800 1500", [832, 862], [1427, 1432]),
    // n92
    _Band("800 1500", [832, 862], [1432, 1517]),
    // n93
    _Band("900 1500", [880, 915], [1427, 1432]),
    // n94
    _Band("900 1500", [880, 915], [1432, 1517]),
    // n95
    _Band("2100", [2010, 2025]),
    // n96
    _Band("6000", [5925, 7125]),
    // n97
    _Band("2300", [2300, 2400]),
    // n98
    _Band("1900", [1880, 1920]),
    // n99
    _Band("1600", [1626.5, 1660.5]),
    // n100
    _Band("900", [874.4, 880], [919.4, 925]),
    // n101
    _Band("1900", [1900, 1910]),
    // n102
    _Band("6200", [5925, 6425]),
    // n104
    _Band("6700", [6425, 7125]),
    // n105
    _Band("600", [663, 703], [612, 652]),
    // n106
    _Band("900", [896, 901], [935, 940]),
    // n109
    _Band("700 1500", [703, 733], [1432, 1517]),
    // n110
    _Band("1400", [1390, 1395], [1432, 1435]),

    // Frequency Range 2
    // n257
    _Band("28 GHz", [26500, 29500]),
    // n258
    _Band("26 GHz", [24250, 27500]),
    // n259
    _Band("41 GHz", [39500, 43500]),
    // n260
    _Band("39 GHz", [37000, 40000]),
    // n261
    _Band("28 GHz", [27500, 28350]),
    // n262
    _Band("47 GHz", [47200, 48200]),
    // n263
    _Band("60 GHz", [57000, 71000]),
  ];

  _Band? bestMatch;
  double minWidth = double.infinity;

  for (var band in bands) {
    double? width = band.matches(freqMHz);
    if (width != null) {
      if (width < minWidth) {
        minWidth = width;
        bestMatch = band;
      }
    }
  }

  return bestMatch?.name ?? '???';
}

class _Band {
  final String name;
  final List<double>? range1;
  final List<double>? range2;

  _Band(this.name, [this.range1, this.range2]);

  double? matches(double freq) {
    if (range1 != null && freq >= range1![0] && freq <= range1![1]) {
      return range1![1] - range1![0];
    }
    if (range2 != null && freq >= range2![0] && freq <= range2![1]) {
      return range2![1] - range2![0];
    }
    return null;
  }
}
